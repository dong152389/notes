(window.webpackJsonp=window.webpackJsonp||[]).push([[390],{1602:function(a,t,s){"use strict";s.r(t);var e=s(26),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"配置-docker-registry-客户端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置-docker-registry-客户端"}},[a._v("#")]),a._v(" 配置 Docker Registry 客户端")]),a._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[a._v("#")]),a._v(" 概述")]),a._v(" "),s("p",[a._v("我们的教学案例使用的是 Ubuntu Server 16.04 LTS 版本，属于 "),s("code",[a._v("systemd")]),a._v(" 系统，需要在 "),s("code",[a._v("/etc/docker/daemon.json")]),a._v(" 中增加如下内容（如果文件不存在请新建该文件）")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('{\n  "registry-mirrors": [\n    "https://registry.docker-cn.com"\n  ],\n  "insecure-registries": [\n    "ip:5000"\n  ]\n}\n')])])]),s("blockquote",[s("p",[a._v("注意：该文件必须符合 json 规范，否则 Docker 将不能启动。")])]),a._v(" "),s("p",[a._v("之后重新启动服务。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$ sudo systemctl daemon-reload\n$ sudo systemctl restart docker\n")])])]),s("h2",{attrs:{id:"检查客户端配置是否生效"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检查客户端配置是否生效"}},[a._v("#")]),a._v(" 检查客户端配置是否生效")]),a._v(" "),s("p",[a._v("使用 "),s("code",[a._v("docker info")]),a._v(" 命令手动检查，如果从配置中看到如下内容，说明配置成功（192.168.75.133 为教学案例 IP）")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Insecure Registries:\n 192.168.75.133:5000\n 127.0.0.0/8\n")])])]),s("h2",{attrs:{id:"测试镜像上传"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试镜像上传"}},[a._v("#")]),a._v(" 测试镜像上传")]),a._v(" "),s("p",[a._v("我们以 Nginx 为例测试镜像上传功能")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("## 拉取一个镜像\ndocker pull nginx\n\n## 查看全部镜像\ndocker images\n\n## 标记本地镜像并指向目标仓库（ip:port/image_name:tag，该格式为标记版本号）\ndocker tag nginx 192.168.75.133:5000/nginx\n\n## 提交镜像到仓库\ndocker push 192.168.75.133:5000/nginx\n")])])]),s("h2",{attrs:{id:"查看全部镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看全部镜像"}},[a._v("#")]),a._v(" 查看全部镜像")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("curl -XGET http://192.168.75.133:5000/v2/_catalog\n")])])]),s("h2",{attrs:{id:"查看指定镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看指定镜像"}},[a._v("#")]),a._v(" 查看指定镜像")]),a._v(" "),s("p",[a._v("以 Nginx 为例，查看已提交的列表")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("curl -XGET http://192.168.75.133:5000/v2/nginx/tags/list\n")])])]),s("h2",{attrs:{id:"测试拉取镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试拉取镜像"}},[a._v("#")]),a._v(" 测试拉取镜像")]),a._v(" "),s("ul",[s("li",[a._v("先删除镜像")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("docker rmi nginx\ndocker rmi 192.168.75.133:5000/nginx\n")])])]),s("ul",[s("li",[a._v("再拉取镜像")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("docker pull 192.168.75.133:5000/nginx\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);