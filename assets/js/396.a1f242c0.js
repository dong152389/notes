(window.webpackJsonp=window.webpackJsonp||[]).push([[396],{1614:function(t,s,n){"use strict";n.r(s);var a=n(26),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"安装-kubeadm"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-kubeadm"}},[t._v("#")]),t._v(" 安装 kubeadm")]),t._v(" "),n("h2",{attrs:{id:"概述"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述")]),t._v(" "),n("p",[t._v("kubeadm 是 kubernetes 的集群安装工具，能够快速安装 kubernetes 集群。")]),t._v(" "),n("h2",{attrs:{id:"配置软件源"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#配置软件源"}},[t._v("#")]),t._v(" 配置软件源")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装系统工具")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -y apt-transport-https\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 GPG 证书")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" apt-key "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" -\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写入软件源；注意：我们用系统代号为 bionic，但目前阿里云不支持，所以沿用 16.04 的 xenial")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("cat")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<<")]),t._v(" EOF "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/etc/apt/sources.list.d/kubernetes.list\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main\n"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" EOF\n")])])]),n("h2",{attrs:{id:"安装-kubeadm-kubelet-kubectl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-kubeadm-kubelet-kubectl"}},[t._v("#")]),t._v(" 安装 kubeadm，kubelet，kubectl")]),t._v(" "),n("div",{staticClass:"language-bash extra-class"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update  \n\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("kubeadm")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("kubectl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("kubelet")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 报错 kubelet : Depends: kubernetes-cni (= 0.7.5-00) but 0.7.5-00 is to be installed")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 卸载 kubernetes-cni")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" remove  kubernetes-cni \n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装指定版本 kubernetes-cni")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" kubernetes-cni"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.7")]),t._v(".5-00\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("kubeadm")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("kubectl")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00 "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("kubelet")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装过程如下，注意 kubeadm 的版本号")]),t._v("\nReading package lists"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". Done\nBuilding dependency tree       \nReading state information"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". Done\nThe following additional packages will be installed:\n  conntrack cri-tools kubernetes-cni socat\nThe following NEW packages will be installed:\n  conntrack cri-tools kubeadm kubectl kubelet kubernetes-cni socat\n"),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" upgraded, "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v(" newly installed, "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" to remove and "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("96")]),t._v(" not upgraded.\nNeed to get "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("50.6")]),t._v(" MB of archives.\nAfter this operation, "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("290")]),t._v(" MB of additional disk space will be used.\nGet:1 http://mirrors.aliyun.com/ubuntu bionic/main amd64 conntrack amd64 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(":1.4.4+snapshot20161117-6ubuntu2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30.6")]),t._v(" kB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:2 http://mirrors.aliyun.com/ubuntu bionic/main amd64 socat amd64 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.7")]),t._v(".3.2-2ubuntu2 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("342")]),t._v(" kB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:3 https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial/main amd64 cri-tools amd64 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.12")]),t._v(".0-00 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("5,343")]),t._v(" kB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:4 https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial/main amd64 kubernetes-cni amd64 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.7")]),t._v(".5-00 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("6,473")]),t._v(" kB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:5 https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial/main amd64 kubelet amd64 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("21.5")]),t._v(" MB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:6 https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial/main amd64 kubectl amd64 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8,806")]),t._v(" kB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nGet:7 https://mirrors.aliyun.com/kubernetes/apt kubernetes-xenial/main amd64 kubeadm amd64 "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8,150")]),t._v(" kB"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nFetched "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("50.6")]),t._v(" MB "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" 5s "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("9,912")]),t._v(" kB/s"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \nSelecting previously unselected package conntrack.\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Reading database "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("67205")]),t._v(" files and directories currently installed."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nPreparing to unpack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./0-conntrack_1%3a1.4.4+snapshot20161117-6ubuntu2_amd64.deb "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUnpacking conntrack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(":1.4.4+snapshot20161117-6ubuntu2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSelecting previously unselected package cri-tools.\nPreparing to unpack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./1-cri-tools_1.12.0-00_amd64.deb "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUnpacking cri-tools "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.12")]),t._v(".0-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSelecting previously unselected package kubernetes-cni.\nPreparing to unpack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./2-kubernetes-cni_0.7.5-00_amd64.deb "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUnpacking kubernetes-cni "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.7")]),t._v(".5-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSelecting previously unselected package socat.\nPreparing to unpack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./3-socat_1.7.3.2-2ubuntu2_amd64.deb "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUnpacking socat "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.7")]),t._v(".3.2-2ubuntu2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSelecting previously unselected package kubelet.\nPreparing to unpack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./4-kubelet_1.14.1-00_amd64.deb "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUnpacking kubelet "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSelecting previously unselected package kubectl.\nPreparing to unpack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./5-kubectl_1.14.1-00_amd64.deb "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUnpacking kubectl "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSelecting previously unselected package kubeadm.\nPreparing to unpack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("./6-kubeadm_1.14.1-00_amd64.deb "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nUnpacking kubeadm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSetting up conntrack "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(":1.4.4+snapshot20161117-6ubuntu2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSetting up kubernetes-cni "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.7")]),t._v(".5-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSetting up cri-tools "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.12")]),t._v(".0-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSetting up socat "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.7")]),t._v(".3.2-2ubuntu2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nSetting up kubelet "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nCreated symlink /etc/systemd/system/multi-user.target.wants/kubelet.service → /lib/systemd/system/kubelet.service.\nSetting up kubectl "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nProcessing triggers "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" man-db "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.8")]),t._v(".3-2ubuntu0.1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注意这里的版本号，我们使用的是 kubernetes v1.14.1")]),t._v("\nSetting up kubeadm "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.14")]),t._v(".1-00"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置 kubelet 自启动，并启动 kubelet")]),t._v("\nsystemctl "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v(" kubelet "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" systemctl start kubelet\n")])])]),n("ul",[n("li",[t._v("kubeadm：用于初始化 Kubernetes 集群")]),t._v(" "),n("li",[t._v("kubectl：Kubernetes 的命令行工具，主要作用是部署和管理应用，查看各种资源，创建，删除和更新组件")]),t._v(" "),n("li",[t._v("kubelet：主要负责启动 Pod 和容器")])])])}),[],!1,null,null,null);s.default=e.exports}}]);