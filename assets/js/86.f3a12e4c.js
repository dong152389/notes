(window.webpackJsonp=window.webpackJsonp||[]).push([[86],{1476:function(t,s,a){"use strict";a.r(s);var n=a(26),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"生命周期中-hook"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#生命周期中-hook"}},[t._v("#")]),t._v(" 生命周期中 Hook")]),t._v(" "),n("p",[t._v("生命周期中的这些钩子函数都是由 gradle 自动回调完成的,利用这些钩子函数可以帮助我们实现一些我们想要的功能。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(814),alt:""}})]),t._v(" "),n("p",[t._v("Gradle 在生命周期各个阶段都提供了用于回调的钩子函数")]),t._v(" "),n("ul",[n("li",[n("font",{attrs:{color:"#1102ff"}},[t._v("Gradle 初始化阶段")]),t._v(" "),n("ul",[n("li",[t._v("在 settings.gradle 执行完后,会回调 Gradle 对象的 settingsEvaluated 方法。")]),t._v(" "),n("li",[t._v("在构建所有工程 build.gradle 对应的 Project 对象后,也既初始化阶段完毕，会回调 Gradle 对象的 projectsLoaded 方法。")])])],1),t._v(" "),n("li",[n("font",{attrs:{color:"#1102ff"}},[t._v("Gradle 配置阶段")]),t._v(" "),n("ul",[n("li",[t._v("Gradle 会循环执行每个工程的 build.gradle 脚本文件")]),t._v(" "),n("li",[t._v("在执行当前工程 build.gradle 前，会回调 Gradle 对象的 beforeProject 方法和当前 Project 对象的 beforeEvaluate 方法，虽然 beforeEvalute 属于 project 的生命周期, 但是此时 build script 尚未被加载, 所以 beforeEvaluate 的设置依然要在 init script 或 setting script 中进行,不要在 build script 中使用 project.beforeEvaluate 方法")]),t._v(" "),n("li",[t._v("在执行当前工程 build.gradle 后，会回调 Gradle 对象的 afterProject 方法和当前 Project 对象的 afterEvaluate 方法")]),t._v(" "),n("li",[t._v("在所有工程的 build.gradle 执行完毕后，会回调 Gradle 对象的 projectsEvaluated 方法")]),t._v(" "),n("li",[t._v("在构建 Task 依赖有向无环图后,也就是配置阶段完毕,会回调 TaskExecutionGraph 对象的 whenReady 方法")])])],1),t._v(" "),n("li",[n("font",{attrs:{color:"#1102ff"}},[t._v("Gradle 执行阶段")]),t._v(" "),n("ul",[n("li",[t._v("Gradle 会循环执行 Task 及其依赖的 Task")]),t._v(" "),n("li",[t._v("在当前 Task 执行之前,会回调 TaskExecutionGraph 对象的 beforeTask 方法")]),t._v(" "),n("li",[t._v("在当前 Task 执行之后,会回调 TaskExecutionGraph 对象的 afterTask 方法")])])],1),t._v(" "),n("li",[n("font",{attrs:{color:"#1102ff"}},[t._v("当所有的 Task 执行完毕后，会回调 Gradle 对象的 buildFinish 方法")])],1)]),t._v(" "),n("blockquote",[n("p",[t._v("Gradle 执行脚本文件的时候会生成对应的实例，主要有如下几种对象：")]),t._v(" "),n("ol",[n("li",[t._v("Gradle 对象：在项目初始化时构建，全局单例存在，只有这一个对象。")]),t._v(" "),n("li",[t._v("Project 对象：每一个build.gradle文件都会转换成一个 Project 对象，类似于 maven 中的 pom.xml 文件。")]),t._v(" "),n("li",[t._v("Settings 对象：settings.gradle 会转变成一个 settings 对象，和整个项目是一对一的关系，一般只用到 include 方法。")]),t._v(" "),n("li",[t._v("Task对象：从前面的有向无环图中， 我们也可以看出， gradle最终是基于Task的，一个项目可以有一个或者多个Task。")])])]),t._v(" "),n("p",[n("font",{attrs:{color:"#1102ff"}},[t._v("钩子函数代码演示：项目目录结构如下：")])],1),t._v(" "),n("p",[n("img",{attrs:{src:a(815),alt:""}})]),t._v(" "),n("p",[t._v("在 root project 的 settings.gradle 文件中添加：")]),t._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[t._v("gradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("settingsEvaluated "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//1.settingsEvaluated钩子函数,在初始化阶段完成")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"settingsEvaluated"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" gradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("projectsLoaded "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//2.projectsLoaded钩子函数,在初始化阶段完成")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"projectsLoaded"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//声明一个变量：表示当前项目名,在每次执行某个项目的beforeEvaluate方法时先给projectName变量赋值")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//这样方便在：gradle.beforeProject和afterProject两个钩子函数使用。")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" projectName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('""')]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addProjectEvaluationListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProjectEvaluationListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//3.执行各个project的beforeEvaluate：在配置阶段完成")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("beforeEvaluate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Project project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        projectName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name\n        println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' Project beforeEvaluate"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//5.执行各个project的afterEvaluate：在配置阶段完成")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("afterEvaluate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Project project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ProjectState projectState"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' Project afterEvaluate"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beforeProject "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//4.执行各个project的beforeProject：在配置阶段完成")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("projectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' beforeProject..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("afterProject "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//6.执行各个project的afterProject：在配置阶段完成")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("projectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' afterProject..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//7.所有工程的 build.gradle 执行完毕后，回调 Gradle 对象的 projectsEvaluated 方法：在配置阶段完成")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" rootProjectName"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("rootProject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("projectsEvaluated "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("rootProjectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' projectsEvaluated..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//8.配置阶段完毕后，回调 TaskExecutionGraph 对象的 whenReady 方法：在配置阶段完成")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("whenReady "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("rootProjectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' taskGraph whenReady..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//9.在当前Task执行之前,会回调 TaskExecutionGraph 对象的 beforeTask方法：在执行阶段完成")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beforeTask "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("task "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"this is the task '),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" of the project "),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' beforeTask.."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//10.在当前Task执行之后,会回调 TaskExecutionGraph 对象的 afterTask方法：在执行阶段完成")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("afterTask "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("task "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"this is the task '),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" of the project "),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' afterTask.."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//11.当所有的 Task 执行完毕后，会回调 Gradle 对象的 buildFinish 方法：在执行阶段完成")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("buildFinished "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("rootProjectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' buildFinished..."')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("在 root 的 build.gradle 文件中添加：")]),t._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[t._v("task A "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"root taskA"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doFirst")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"root taskA doFirst"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doLast")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"root taskA doLast"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("在 subject01 的 build.gradle 文件中添加：")]),t._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[t._v("task B "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject01 taskB"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doFirst")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject01 taskB doFirst"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doLast")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject01 taskB doLast"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("在 subject02 的 build.gradle 文件中添加：")]),t._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//task C在上面")]),t._v("\ntask C"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//依赖task D")]),t._v("\n    dependsOn "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'D'")]),t._v("\n    \tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject02 taskC"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doFirst")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject02 taskC doFirst"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doLast")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject02 taskC doLast"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//task D在下面")]),t._v("\ntask D "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject02 taskD"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doFirst")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject02 taskD doFirst"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n    "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("doLast")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \tprintln "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"SubProject02 taskD doLast"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("测试：在 root 工程的根目录执行"),n("code",[t._v("gradle C")]),t._v("。就能看到 gradle 生命周期的三个阶段，及每个阶段执行的钩子函数、还有在执行阶段有依赖关系的任务的执行顺序问题。")]),t._v(" "),n("p",[n("font",{attrs:{color:"#668bce"}},[t._v("拓展1")]),t._v("：在 settings.gradle 中添加监听器，查看 task "),n("strong",[t._v("有向无环图")])],1),t._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[t._v("gradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("addTaskExecutionGraphListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TaskExecutionGraphListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//生成有向无环图")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("graphPopulated")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TaskExecutionGraph taskExecutionGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        taskExecutionGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("allTasks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("task "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//核心逻辑:通过taskExecutionGraph获得所有的task")]),t._v("\n            taskExecutionGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("allTasks"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("releaseTask "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"段锋东:"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" releaseTask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getProject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('":"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" releaseTask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("测试：在 root 工程根目录下执行"),n("code",[t._v("gradle C")]),t._v("。查看测试结果")]),t._v(" "),n("p",[n("img",{attrs:{src:a(816),alt:""}})]),t._v(" "),n("p",[n("font",{attrs:{color:"#668bce"}},[t._v("拓展 2")]),t._v("： 计算 Gradle 构建过程中各个阶段的耗时:需要注意，这里只是计算了初始化阶段的 settings 文件，并没有计算 init.gradle 初始化的时间。")],1),t._v(" "),n("div",{staticClass:"language-groovy extra-class"},[n("pre",{pre:!0,attrs:{class:"language-groovy"}},[n("code",[t._v("projectName "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rootProject"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//定义项目名")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" beginOfSetting "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//初始化阶段开始时间")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" beginOfConfig "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置阶段开始时间")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" configHasBegin "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置阶段是否开始了，只执行一次")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" beginOfProjectConfig "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HashMap")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//存放每个 build.gradle 执行之前的时间")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" beginOfTaskExecute "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//执行阶段开始时间")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("projectsLoaded "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//初始化阶段执行完毕")]),t._v("\n    println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("projectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("工程 初始化总耗时 "),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" beginOfSetting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' ms"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//build.gradle 执行前")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beforeProject "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Project project "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("configHasBegin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        configHasBegin "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n        beginOfConfig "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    beginOfProjectConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//build.gradle 执行后")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("afterProject "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Project project "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" begin "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" beginOfProjectConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" projectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"根工程'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("projectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" 配置阶段耗时："),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" begin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' ms"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"子工程'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("project"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(" 配置阶段耗时："),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" begin"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' ms"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("whenReady "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//配置阶段完毕")]),t._v("\n    println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"整个'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("projectName"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("项目在配置阶段总耗时："),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" beginOfConfig"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' ms"')]),t._v("\n    beginOfTaskExecute "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//执行阶段开始")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("taskGraph"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beforeTask "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Task task "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v("\n    task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("doFirst "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beginOfTask "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("doLast "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v("在执行阶段耗时："),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" task"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("beginOfTask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' ms"')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\ngradle"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("buildFinished "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//执行阶段完毕")]),t._v("\n    println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('" 执行阶段总耗时：'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" beginOfTaskExecute"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' ms"')]),t._v("\n    println "),n("span",{pre:!0,attrs:{class:"token string gstring"}},[t._v('" 整个构建过程耗时：'),n("span",{pre:!0,attrs:{class:"token expression"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("System"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" beginOfSetting"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),t._v(' ms"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports},814:function(t,s,a){t.exports=a.p+"assets/img/Snipaste_2022-10-08_16-01-29.59a75ad4.png"},815:function(t,s,a){t.exports=a.p+"assets/img/Snipaste_2022-10-09_09-31-56.ab2077cb.png"},816:function(t,s,a){t.exports=a.p+"assets/img/Snipaste_2022-10-10_11-04-36.31631ff5.png"}}]);