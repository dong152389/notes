(window.webpackJsonp=window.webpackJsonp||[]).push([[252],{1375:function(a,t,s){"use strict";s.r(t);var e=s(26),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"附-linux-下手动安装-zookeeper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#附-linux-下手动安装-zookeeper"}},[a._v("#")]),a._v(" 附：Linux 下手动安装 Zookeeper")]),a._v(" "),s("p",[a._v("Zookeeper 部署有三种方式，单机模式、集群模式、伪集群模式，以下采用手动安装的方式部署")]),a._v(" "),s("p",[s("strong",[a._v("注意：")]),a._v(" 集群为大于等于3个奇数，如 3、5、7,不宜太多，集群机器多了选举和数据同步耗时长，不稳定。")]),a._v(" "),s("h2",{attrs:{id:"单机模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单机模式"}},[a._v("#")]),a._v(" 单机模式")]),a._v(" "),s("h3",{attrs:{id:"下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#下载"}},[a._v("#")]),a._v(" 下载")]),a._v(" "),s("p",[a._v("进入要下载的版本的目录，选择 "),s("code",[a._v(".tar.gz")]),a._v(" 文件下载，下载链接：http://archive.apache.org/dist/zookeeper/")]),a._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[s("strong",[a._v("注意：")]),a._v(" 需要先安装 "),s("code",[a._v("Java")])]),a._v(" "),s("p",[a._v("使用 "),s("code",[a._v("tar")]),a._v(" 解压要安装的目录即可，以 "),s("code",[a._v("3.4.13")]),a._v(" 版本为例，解压到 "),s("code",[a._v("/usr/local/zookeeper-3.4.13")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" -zxvf zookeeper-3.4.13.tar.gz -C /usr/local\n")])])]),s("h3",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[a._v("#")]),a._v(" 配置")]),a._v(" "),s("p",[a._v("在根目录下创建 "),s("code",[a._v("data")]),a._v(" 和 "),s("code",[a._v("logs")]),a._v(" 两个目录用于存储数据和日志")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /usr/local/zookeeper-3.4.13\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" data\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" logs\n")])])]),s("p",[a._v("在 "),s("code",[a._v("conf")]),a._v(" 目录下新建 "),s("code",[a._v("zoo.cfg")]),a._v(" 文件，写入以下内容保存")]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("tickTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper-3.4.13/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataLogDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper-3.4.13/logs")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("clientPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2181")]),a._v("\n")])])]),s("h3",{attrs:{id:"启动和停止"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动和停止"}},[a._v("#")]),a._v(" 启动和停止")]),a._v(" "),s("p",[a._v("进入 "),s("code",[a._v("bin")]),a._v(" 目录，启动、停止、重启和查看当前节点状态")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("./zkServer.sh start\n./zkServer.sh stop\n./zkServer.sh restart\n./zkServer.sh status\n")])])]),s("h2",{attrs:{id:"伪集群模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#伪集群模式"}},[a._v("#")]),a._v(" 伪集群模式")]),a._v(" "),s("p",[a._v("伪集群模式就是在同一主机启动多个 zookeeper 并组成集群，下边以在 192.168.10.134 主机上创 3 个 zookeeper 组集群为例。")]),a._v(" "),s("p",[a._v("将通过单机模式安装的 zookeeper，复制成 zookeeper1/zookeeper2/zookeeper3 三份")]),a._v(" "),s("h3",{attrs:{id:"zookeeper1"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper1"}},[a._v("#")]),a._v(" zookeeper1")]),a._v(" "),s("ul",[s("li",[a._v("修改配置文件")])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("tickTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper1/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataLogDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper1/logs")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("clientPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2181")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("initLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("syncLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:2888:3888")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:4888:5888")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:6888:7888")]),a._v("\n")])])]),s("ul",[s("li",[a._v("设置服务器 ID")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'1'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" data/myid\n")])])]),s("h3",{attrs:{id:"zookeeper2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper2"}},[a._v("#")]),a._v(" zookeeper2")]),a._v(" "),s("ul",[s("li",[a._v("修改配置文件")])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("tickTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper2/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataLogDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper2/logs")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("clientPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2181")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("initLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("syncLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:2888:3888")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:4888:5888")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:6888:7888")]),a._v("\n")])])]),s("ul",[s("li",[a._v("设置服务器 ID")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'2'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" data/myid\n")])])]),s("h3",{attrs:{id:"zookeeper3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zookeeper3"}},[a._v("#")]),a._v(" zookeeper3")]),a._v(" "),s("ul",[s("li",[a._v("修改配置文件")])]),a._v(" "),s("div",{staticClass:"language-properties extra-class"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("tickTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper3/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("dataLogDir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("/usr/local/zookeeper3/logs")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("clientPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2181")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("initLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("syncLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("2")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:2888:3888")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:4888:5888")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("server.3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[a._v("192.168.10.134:6888:7888")]),a._v("\n")])])]),s("ul",[s("li",[a._v("设置服务器 ID")])]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'3'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" data/myid\n")])])]),s("h3",{attrs:{id:"启动和停止-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动和停止-2"}},[a._v("#")]),a._v(" 启动和停止")]),a._v(" "),s("p",[a._v("分别启动服务器，顺序无所谓")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("./zkServer.sh start\n./zkServer.sh stop\n./zkServer.sh restart\n./zkServer.sh status\n")])])]),s("h2",{attrs:{id:"集群模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#集群模式"}},[a._v("#")]),a._v(" 集群模式")]),a._v(" "),s("p",[a._v("集群模式就是在不同主机上安装 zookeeper 然后组成集群的模式，操作步骤同上，此处不再赘述。")])])}),[],!1,null,null,null);t.default=r.exports}}]);